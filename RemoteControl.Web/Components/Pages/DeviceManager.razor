@page "/devices"
@inject NavigationManager Nav

@code {
    // Fix CS0105: Đã xóa dòng using Components.Layout vì nó đã có trong _Imports.razor

    protected override void OnInitialized()
    {
        // Cách set title an toàn hơn nếu MainLayout không static
        // MainLayout.PageTitle = "Device Manager";
    }

    // Fix CS8618: Khởi tạo giá trị mặc định cho các thuộc tính
    class Device
    {
        public string Name { get; set; } = ""; // Gán rỗng để tránh null
        public string Ip { get; set; } = "";
        public string OS { get; set; } = "";
        public bool IsOnline { get; set; }
        public string LastSeen { get; set; } = "";
    }

    List<Device> Devices = new List<Device> {
        new Device { Name = "HR-ADMIN-01", Ip = "192.168.1.101", OS = "Windows 11", IsOnline = true, LastSeen = "Now" },
        new Device { Name = "DEV-WORKSTATION", Ip = "192.168.1.105", OS = "Windows 10", IsOnline = true, LastSeen = "Now" },
        new Device { Name = "RECEPTION-FRONT", Ip = "192.168.1.112", OS = "Windows 10", IsOnline = false, LastSeen = "2h ago" },
        new Device { Name = "SERVER-BACKUP", Ip = "192.168.1.200", OS = "Windows Server", IsOnline = true, LastSeen = "Now" },
        new Device { Name = "GUEST-LAPTOP", Ip = "192.168.1.150", OS = "Windows 11", IsOnline = false, LastSeen = "1d ago" },
    };

    // Hàm điều hướng: Khi bấm nút sẽ nhảy sang trang /devices/{tên_máy}
    void Connect(string name)
    {
        Nav.NavigateTo($"/devices/{name}");
    }
}

<SearchInput />

<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
    @foreach (var device in Devices)
    {
        <DeviceCard Name="@device.Name"
                    Ip="@device.Ip"
                    OS="@device.OS"
                    IsOnline="@device.IsOnline"
                    LastSeen="@device.LastSeen"
                    OnConnect="() => Connect(device.Name)" />
    }
</div>